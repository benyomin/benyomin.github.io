library(memisc)
yr2000 <- spss.portable.file("../rawData/census/f461/f461fam.por")
yr2001 <- spss.portable.file('../rawData/census/f462/f462fam.por')
yr2002 <- spss.portable.file("../rawData/census/f463/f463fam.por")
yr2003 <- spss.portable.file("../rawData/census/f464/f464fam.por")
yr2004 <- spss.portable.file("../rawData/census/f466/f466fam.por")
yr2005 <- spss.portable.file("../rawData/census/f467/f467fam.por")
yr2006 <- spss.portable.file("../rawData/census/f468/n468fam.por")#n-not-f
yr2007 <- spss.portable.file("../rawData/census/f469/f469fam.por")
yr2008 <- spss.portable.file("../rawData/census/f474/f474fam.por")
yr2009 <- spss.portable.file("../rawData/census/f472/f472fam.por")
yr2010 <- spss.portable.file("../rawData/census/f471/f471fam.por")
yr2011 <- spss.portable.file("../rawData/census/f459/f459fam.por")
yr2012 <- spss.portable.file("../rawData/census/f458/f458fam.por")
yr2013 <- spss.portable.file("../rawData/census/f457/f457fam.por")
yr2014 <- spss.portable.file("../rawData/census/f456/f456fam.por")
##ind2004 <- spss.get("../rawData/census/f466/f466ind.por",
##                 use.value.labels = TRUE)
library(Hmisc)
exp2004 <- spss.get("../rawData/census/f466/f466exp.por",
                  use.value.labels = TRUE)
exp2005 <- spss.get("../rawData/census/f467/f467exp.por",
                  use.value.labels = TRUE)
exp2006 <- spss.get("../rawData/census/f468/f468exp.por",         #f again
                  use.value.labels = TRUE)
exp2007 <- spss.get("../rawData/census/f469/f469exp.por",
                  use.value.labels = TRUE)
exp2008 <- spss.get("../rawData/census/f474/f474exp.por",
                  use.value.labels = TRUE)
exp2009 <- spss.get("../rawData/census/f472/f472exp.por",
                    use.value.labels = TRUE)
exp2010 <- spss.get("../rawData/census/f471/f471exp.por",
                    use.value.labels = TRUE)
exp2011 <- spss.get("../rawData/census/f459/f459exp.por",
                    use.value.labels = TRUE)
exp2012 <- spss.get("../rawData/census/f458/f458exp.por",
                    use.value.labels = TRUE)
exp2013 <- spss.get("../rawData/census/f457/f457exp.por",
                    use.value.labels = TRUE)
exp2014 <- spss.get("../rawData/census/f456/f456exp.por",
                    use.value.labels = TRUE)
library(dplyr)
qs = read.csv("./whichQuestion2.csv", header=TRUE)
##q1  total income
##q3  hhnum - household number (id variable)
##q23       - income from rental of owned apt.
##q64       - total household consumption
##q294      - monthly rental expense
##q297      - imputed rent for owned dwelling
exp2004df <-as.data.frame(exp2004)
exp2004s <-dplyr::select(exp2004df, Q1,Q22,Q64,Q294,Q297,WEIGHT,HHNUM)
exp2005df <-as.data.frame(exp2005)
exp2005s <-dplyr::select(exp2005df, Q1,Q24,Q69,Q308,Q311,WEIGHT,HHNUM)
exp2006df <-as.data.frame(exp2006)
exp2006s <-dplyr::select(exp2006df, Q1,Q24,Q66,Q303,Q306,WEIGHT,HHNUM)
exp2007df <-as.data.frame(exp2007)
exp2007s <-dplyr::select(exp2007df, Q1,Q24,Q69,Q321,Q326,WEIGHT,HHNUM)
exp2008df <-as.data.frame(exp2008)
exp2008s <-dplyr::select(exp2008df, Q1,Q24,Q69,Q325,Q330,WEIGHT,HHNUM)
exp2009df <-as.data.frame(exp2009)
exp2009s <-dplyr::select(exp2009df, Q1,Q26,Q77,Q358,Q363,WEIGHT,HHNUM)
exp2010df <-as.data.frame(exp2010)
exp2010s <-dplyr::select(exp2010df, Q1,Q27,Q78,Q361,Q367,WEIGHT,HHNUM)
exp2011df <-as.data.frame(exp2011)
exp2011s <-dplyr::select(exp2011df, Q1,Q28,Q81,Q366,Q372,WEIGHT,HHNUM)
exp2012df <-as.data.frame(exp2012)
exp2012s <-dplyr::select(exp2012df, Q1,Q28,Q81,Q366,Q372,WEIGHT,HHNUM)
exp2013df <-as.data.frame(exp2013)
exp2013s <-dplyr::select(exp2013df, Q1,Q28,Q83,Q382,Q387,WEIGHT,HHNUM)
exp2014df <-as.data.frame(exp2014)
exp2014s <-dplyr::select(exp2014df, Q1,Q28,Q84,Q383,Q389,WEIGHT,HHNUM)
## Q294 is about rent, if 294 > 0, household paid rent
exp2004renters <-subset(exp2004s, Q294>0)
exp2004owners <-subset(exp2004s, Q294==0)
exp2005renters <-subset(exp2005s, Q308>0)
exp2005owners <-subset(exp2005s, Q308==0)
exp2006renters <-subset(exp2006s, Q303>0)
exp2006owners <-subset(exp2006s, Q303==0)
exp2007renters <-subset(exp2007s, Q321>0)
exp2007owners <-subset(exp2007s, Q321==0)
exp2008renters <-subset(exp2008s, Q325>0)
exp2008owners <-subset(exp2008s, Q325==0)
exp2009renters <-subset(exp2009s, Q358>0)
exp2009owners <-subset(exp2009s, Q358==0)
exp2010renters <-subset(exp2010s, Q361>0)
exp2010owners <-subset(exp2010s, Q361==0)
exp2011renters <-subset(exp2011s, Q366>0)
exp2011owners <-subset(exp2011s, Q366==0)
exp2012renters <-subset(exp2012s, Q366>0)
exp2012owners <-subset(exp2012s, Q366==0)
exp2013renters <-subset(exp2013s, Q382>0)
exp2013owners <-subset(exp2013s, Q382==0)
exp2014renters <-subset(exp2014s, Q383>0)
exp2014owners <-subset(exp2014s, Q383==0) 
## write-out the data
## dump(exp2004s)
## dump(exp2005s)
## dump(exp2006s)
## dump(exp2007s)
## dump(exp2008s)
## dump(exp2009s)
## dump(exp2010s)
## dump(exp2011s)
## dump(exp2012s)
## dump(exp2013s)
## dump(exp2014s)
#
# yr.2000<- subset(yr2000,
#                  select=c(
#                      valueOfApt = v42,
#                      netIncome = v43,
#                      aptSize = v40
#                  ))
# yr2001 <- spss.portable.file('../rawData/census/f462/f462fam.por')
# yr.2001 <-subset(yr2001,
#                  select=c(
#                      valueOfApt = v42,
#                      netIncome = v43,
#                      aptSize = v40,
#                      ownApt = v48
#                  ))
#description(yr.2001)
#yr2002 <- spss.portable.file("../rawData/census/f463/f463fam.por")
#yr.2002 <-subset(yr2002,
 #                select=c(
  #                   valueOfApt = v42,
   #                  netIncome = v43
           #          aptSize = v40,
           #          ownApt = v48
    ##             ))
# yr.2002 <-within(yr.2002,{
#     ownApt <- recode(ownApt,
#                      1 -> "Yes", 
#                      2 -> "No",
#                      9 -> "Missing"
#                          )
# })
yr.2003 <-subset(yr2003,
                 select=c(
                     rent = rent,
                     owner = owner))
yr.2004 <-subset(yr2004,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                     codeloc = codeloc))
yr.2005 <-subset(yr2005,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2006 <-subset(yr2006,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2007 <-subset(yr2007,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2008 <-subset(yr2008,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2009 <-subset(yr2009,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2010 <-subset(yr2010,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2011 <-subset(yr2011,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2012 <-subset(yr2012,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2013 <-subset(yr2013,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
yr.2014 <-subset(yr2014,
                 select=c(
                      rent = rent,
                     owner = owner, 
                     hhnum = hhnum,
                     rooms = rooms, 
                   codeloc = codeloc))
